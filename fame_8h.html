<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>CiFEr: include/cifer/abe/fame.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CiFEr
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_3186075824eb6c6fc16d275650bc36ef.html">cifer</a></li><li class="navelem"><a class="el" href="dir_0d628d3c9b21a09631269a5f84e03143.html">abe</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">fame.h File Reference<div class="ingroups"><a class="el" href="group__abe.html">ABE schemes</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>This is a ciphertext policy (CP) attribute based (ABE) scheme based on Shashank Agrawal and Melissa Chase: "FAME: Fast Attribute-based Message
Encryption" This scheme enables encrypting a message based on a boolean expression determining which attributes are needed for an entity to be able to decrypt. Each key is connected to some attribute, such that only a set of keys whose attributes are sufficient can decrypt the massage. This scheme is a PUBLIC-KEY scheme - no master secret key is needed to encrypt the messages.  
<a href="#details">More...</a></p>

<p><a href="fame_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcfe__fame.html">cfe_fame</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcfe__fame__pub__key.html">cfe_fame_pub_key</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcfe__fame__sec__key.html">cfe_fame_sec_key</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcfe__fame__cipher.html">cfe_fame_cipher</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcfe__fame__attrib__keys.html">cfe_fame_attrib_keys</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a6b7b38ac3d9008b53bfcd037c2fbcb46"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structcfe__fame.html">cfe_fame</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fame_8h.html#a6b7b38ac3d9008b53bfcd037c2fbcb46">cfe_fame</a></td></tr>
<tr class="separator:a6b7b38ac3d9008b53bfcd037c2fbcb46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6658646c874ffd2c7b9226d16012ff25"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structcfe__fame__pub__key.html">cfe_fame_pub_key</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fame_8h.html#a6658646c874ffd2c7b9226d16012ff25">cfe_fame_pub_key</a></td></tr>
<tr class="separator:a6658646c874ffd2c7b9226d16012ff25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61c457708cea7b05690772314270c784"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structcfe__fame__sec__key.html">cfe_fame_sec_key</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fame_8h.html#a61c457708cea7b05690772314270c784">cfe_fame_sec_key</a></td></tr>
<tr class="separator:a61c457708cea7b05690772314270c784"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8a0cc88a3f3b341a44b6800883f63cb"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structcfe__fame__cipher.html">cfe_fame_cipher</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fame_8h.html#ac8a0cc88a3f3b341a44b6800883f63cb">cfe_fame_cipher</a></td></tr>
<tr class="separator:ac8a0cc88a3f3b341a44b6800883f63cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9e3d0bab816f6e4e4edbb498de2220c"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structcfe__fame__attrib__keys.html">cfe_fame_attrib_keys</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fame_8h.html#ac9e3d0bab816f6e4e4edbb498de2220c">cfe_fame_attrib_keys</a></td></tr>
<tr class="separator:ac9e3d0bab816f6e4e4edbb498de2220c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a669d0c2f5a309c8845bc5a6f8aafe7b1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fame_8h.html#a669d0c2f5a309c8845bc5a6f8aafe7b1">cfe_fame_init</a> (<a class="el" href="structcfe__fame.html">cfe_fame</a> *fame)</td></tr>
<tr class="separator:a669d0c2f5a309c8845bc5a6f8aafe7b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b2abb9a8c6a0f97539ed6b86fd93281"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fame_8h.html#a4b2abb9a8c6a0f97539ed6b86fd93281">cfe_fame_free</a> (<a class="el" href="structcfe__fame.html">cfe_fame</a> *fame)</td></tr>
<tr class="separator:a4b2abb9a8c6a0f97539ed6b86fd93281"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbda89f2bfbf832cc7239dbefc966db5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fame_8h.html#adbda89f2bfbf832cc7239dbefc966db5">cfe_fame_sec_key_init</a> (<a class="el" href="structcfe__fame__sec__key.html">cfe_fame_sec_key</a> *sk)</td></tr>
<tr class="separator:adbda89f2bfbf832cc7239dbefc966db5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4aaac8c7af538480dbe8f622a99079e8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fame_8h.html#a4aaac8c7af538480dbe8f622a99079e8">cfe_fame_sec_key_free</a> (<a class="el" href="structcfe__fame__sec__key.html">cfe_fame_sec_key</a> *sk)</td></tr>
<tr class="separator:a4aaac8c7af538480dbe8f622a99079e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a489d46433c3ebc91033ee4cdbc6cfb9d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fame_8h.html#a489d46433c3ebc91033ee4cdbc6cfb9d">cfe_fame_generate_master_keys</a> (<a class="el" href="structcfe__fame__pub__key.html">cfe_fame_pub_key</a> *pk, <a class="el" href="structcfe__fame__sec__key.html">cfe_fame_sec_key</a> *sk, <a class="el" href="structcfe__fame.html">cfe_fame</a> *fame)</td></tr>
<tr class="separator:a489d46433c3ebc91033ee4cdbc6cfb9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f4e468c5a1acd22f527f46ed2b3a360"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fame_8h.html#a8f4e468c5a1acd22f527f46ed2b3a360">cfe_fame_cipher_init</a> (<a class="el" href="structcfe__fame__cipher.html">cfe_fame_cipher</a> *cipher, <a class="el" href="structcfe__msp.html">cfe_msp</a> *msp)</td></tr>
<tr class="separator:a8f4e468c5a1acd22f527f46ed2b3a360"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa03897e099c3d7c3b6e4f0128cf06be3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fame_8h.html#aa03897e099c3d7c3b6e4f0128cf06be3">cfe_fame_cipher_free</a> (<a class="el" href="structcfe__fame__cipher.html">cfe_fame_cipher</a> *cipher)</td></tr>
<tr class="separator:aa03897e099c3d7c3b6e4f0128cf06be3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58c63200ed5d80f13efee559d6cb73b0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fame_8h.html#a58c63200ed5d80f13efee559d6cb73b0">cfe_fame_encrypt</a> (<a class="el" href="structcfe__fame__cipher.html">cfe_fame_cipher</a> *cipher, FP12_BN254 *msg, <a class="el" href="structcfe__msp.html">cfe_msp</a> *msp, <a class="el" href="structcfe__fame__pub__key.html">cfe_fame_pub_key</a> *pk, <a class="el" href="structcfe__fame.html">cfe_fame</a> *fame)</td></tr>
<tr class="separator:a58c63200ed5d80f13efee559d6cb73b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade3e7adde9ed2270c1a8218c44fd5a0c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fame_8h.html#ade3e7adde9ed2270c1a8218c44fd5a0c">cfe_fame_attrib_keys_init</a> (<a class="el" href="structcfe__fame__attrib__keys.html">cfe_fame_attrib_keys</a> *keys, size_t num_attrib)</td></tr>
<tr class="separator:ade3e7adde9ed2270c1a8218c44fd5a0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace906c385ef5ce6bc7be9206cc5b3c06"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fame_8h.html#ace906c385ef5ce6bc7be9206cc5b3c06">cfe_fame_attrib_keys_free</a> (<a class="el" href="structcfe__fame__attrib__keys.html">cfe_fame_attrib_keys</a> *keys)</td></tr>
<tr class="separator:ace906c385ef5ce6bc7be9206cc5b3c06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ceb339a1ed6336ee1a6cfd914207294"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fame_8h.html#a8ceb339a1ed6336ee1a6cfd914207294">cfe_fame_generate_attrib_keys</a> (<a class="el" href="structcfe__fame__attrib__keys.html">cfe_fame_attrib_keys</a> *keys, int *gamma, size_t num_attrib, <a class="el" href="structcfe__fame__sec__key.html">cfe_fame_sec_key</a> *sk, <a class="el" href="structcfe__fame.html">cfe_fame</a> *fame)</td></tr>
<tr class="separator:a8ceb339a1ed6336ee1a6cfd914207294"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a740d53955478a2863f1e981386b07b"><td class="memItemLeft" align="right" valign="top">cfe_error&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fame_8h.html#a1a740d53955478a2863f1e981386b07b">cfe_fame_decrypt</a> (FP12_BN254 *res, <a class="el" href="structcfe__fame__cipher.html">cfe_fame_cipher</a> *cipher, <a class="el" href="structcfe__fame__attrib__keys.html">cfe_fame_attrib_keys</a> *keys, <a class="el" href="structcfe__fame.html">cfe_fame</a> *fame)</td></tr>
<tr class="separator:a1a740d53955478a2863f1e981386b07b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26545c9f4bd6e4fc26b2c5e51318c5af"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fame_8h.html#a26545c9f4bd6e4fc26b2c5e51318c5af">cfe_strings_concat_for_hash</a> (char *str,...)</td></tr>
<tr class="separator:a26545c9f4bd6e4fc26b2c5e51318c5af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a907c65676e69f263d8ec5a8ddb817c37"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fame_8h.html#a907c65676e69f263d8ec5a8ddb817c37">cfe_int_to_str</a> (int i)</td></tr>
<tr class="separator:a907c65676e69f263d8ec5a8ddb817c37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c2251b9ade6143f49604fb432450cc4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fame_8h.html#a5c2251b9ade6143f49604fb432450cc4">cfe_hash_G1</a> (ECP_BN254 *g, char *str)</td></tr>
<tr class="separator:a5c2251b9ade6143f49604fb432450cc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This is a ciphertext policy (CP) attribute based (ABE) scheme based on Shashank Agrawal and Melissa Chase: "FAME: Fast Attribute-based Message
Encryption" This scheme enables encrypting a message based on a boolean expression determining which attributes are needed for an entity to be able to decrypt. Each key is connected to some attribute, such that only a set of keys whose attributes are sufficient can decrypt the massage. This scheme is a PUBLIC-KEY scheme - no master secret key is needed to encrypt the messages. </p>
</div><h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="a6b7b38ac3d9008b53bfcd037c2fbcb46"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structcfe__fame.html">cfe_fame</a>  <a class="el" href="structcfe__fame.html">cfe_fame</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="structcfe__fame.html">cfe_fame</a> represents the FAME scheme. </p>

</div>
</div>
<a class="anchor" id="a6658646c874ffd2c7b9226d16012ff25"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structcfe__fame__pub__key.html">cfe_fame_pub_key</a>  <a class="el" href="structcfe__fame__pub__key.html">cfe_fame_pub_key</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="structcfe__fame__pub__key.html">cfe_fame_pub_key</a> represents the public key for the FAME scheme.It does not need to be manually initialized by an initialization function. </p>

</div>
</div>
<a class="anchor" id="a61c457708cea7b05690772314270c784"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structcfe__fame__sec__key.html">cfe_fame_sec_key</a>  <a class="el" href="structcfe__fame__sec__key.html">cfe_fame_sec_key</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="structcfe__fame__sec__key.html">cfe_fame_sec_key</a> represents the secret key for the FAME scheme. </p>

</div>
</div>
<a class="anchor" id="ac8a0cc88a3f3b341a44b6800883f63cb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structcfe__fame__cipher.html">cfe_fame_cipher</a>  <a class="el" href="structcfe__fame__cipher.html">cfe_fame_cipher</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="structcfe__fame__cipher.html">cfe_fame_cipher</a> represents the cipher for the FAME scheme. </p>

</div>
</div>
<a class="anchor" id="ac9e3d0bab816f6e4e4edbb498de2220c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structcfe__fame__attrib__keys.html">cfe_fame_attrib_keys</a>  <a class="el" href="structcfe__fame__attrib__keys.html">cfe_fame_attrib_keys</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="structcfe__fame__attrib__keys.html">cfe_fame_attrib_keys</a> represents the keys corresponding to attributes needed for the decryption. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a669d0c2f5a309c8845bc5a6f8aafe7b1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_fame_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__fame.html">cfe_fame</a> *&#160;</td>
          <td class="paramname"><em>fame</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Configures a new instance of the scheme.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fame</td><td>A pointer to an uninitialized struct representing the scheme </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a4b2abb9a8c6a0f97539ed6b86fd93281"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_fame_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__fame.html">cfe_fame</a> *&#160;</td>
          <td class="paramname"><em>fame</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Frees the memory occupied by the struct members. It does not free the memory occupied by the struct itself.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fame</td><td>A pointer to an instance of the scheme (<em>initialized</em> <a class="el" href="structcfe__fame.html">cfe_fame</a> struct) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="adbda89f2bfbf832cc7239dbefc966db5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_fame_sec_key_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__fame__sec__key.html">cfe_fame_sec_key</a> *&#160;</td>
          <td class="paramname"><em>sk</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initializes a secret key.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sk</td><td>A pointer to an uninitialized struct representing the secret key </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a4aaac8c7af538480dbe8f622a99079e8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_fame_sec_key_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__fame__sec__key.html">cfe_fame_sec_key</a> *&#160;</td>
          <td class="paramname"><em>sk</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Frees the memory occupied by the struct members. It does not free the memory occupied by the struct itself.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sk</td><td>A pointer to an instance of the secret key (<em>initialized</em> <a class="el" href="structcfe__fame__sec__key.html">cfe_fame_sec_key</a> struct) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a489d46433c3ebc91033ee4cdbc6cfb9d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_fame_generate_master_keys </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__fame__pub__key.html">cfe_fame_pub_key</a> *&#160;</td>
          <td class="paramname"><em>pk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__fame__sec__key.html">cfe_fame_sec_key</a> *&#160;</td>
          <td class="paramname"><em>sk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__fame.html">cfe_fame</a> *&#160;</td>
          <td class="paramname"><em>fame</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generates a master secret key and a public key.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pk</td><td>A pointer to a <a class="el" href="structcfe__fame__pub__key.html">cfe_fame_pub_key</a> struct, the public key will be saved here; pk does not need to be manually initialized by an initialization function </td></tr>
    <tr><td class="paramname">sk</td><td>A pointer to an initialized <a class="el" href="structcfe__fame__sec__key.html">cfe_fame_sec_key</a> struct, the secret key will be saved here </td></tr>
    <tr><td class="paramname">fame</td><td>A pointer to an initialized struct representing the scheme </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a8f4e468c5a1acd22f527f46ed2b3a360"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_fame_cipher_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__fame__cipher.html">cfe_fame_cipher</a> *&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__msp.html">cfe_msp</a> *&#160;</td>
          <td class="paramname"><em>msp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initializes the ciphertext that will be generated given a MSP structure. A MSP structure is needed to decide how much memory needs to be allocated.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cipher</td><td>A pointer to an uninitialized struct representing the ciphertext </td></tr>
    <tr><td class="paramname">msp</td><td>A pointer to an initialized struct representing the MSP policy </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aa03897e099c3d7c3b6e4f0128cf06be3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_fame_cipher_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__fame__cipher.html">cfe_fame_cipher</a> *&#160;</td>
          <td class="paramname"><em>cipher</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Frees the memory occupied by the struct members. It does not free the memory occupied by the struct itself.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cipher</td><td>A pointer to an instance of the ciphertext (<em>initialized</em> <a class="el" href="structcfe__fame__cipher.html">cfe_fame_cipher</a> struct) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a58c63200ed5d80f13efee559d6cb73b0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_fame_encrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__fame__cipher.html">cfe_fame_cipher</a> *&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FP12_BN254 *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__msp.html">cfe_msp</a> *&#160;</td>
          <td class="paramname"><em>msp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__fame__pub__key.html">cfe_fame_pub_key</a> *&#160;</td>
          <td class="paramname"><em>pk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__fame.html">cfe_fame</a> *&#160;</td>
          <td class="paramname"><em>fame</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The function takes as an input a message, a MSP structure describing a policy which attributes are needed for the decryption, and a public key. It creates an encryption of the message.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cipher</td><td>A pointer to an initialized <a class="el" href="structcfe__fame__cipher.html">cfe_fame_cipher</a> struct, the encryption will be saved here </td></tr>
    <tr><td class="paramname">msg</td><td>An element of FP12_BN254 representing the message </td></tr>
    <tr><td class="paramname">msp</td><td>A pointer to an initialized struct representing the MSP policy </td></tr>
    <tr><td class="paramname">pk</td><td>A pointer to an initialized struct representing the public key </td></tr>
    <tr><td class="paramname">fame</td><td>A pointer to an initialized struct representing the scheme </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ade3e7adde9ed2270c1a8218c44fd5a0c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_fame_attrib_keys_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__fame__attrib__keys.html">cfe_fame_attrib_keys</a> *&#160;</td>
          <td class="paramname"><em>keys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num_attrib</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initializes attribute keys needed for the decryption. The number of attributes needs to be specified to decide how much memory needs to be allocated.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">keys</td><td>A pointer to an uninitialized struct representing the keys </td></tr>
    <tr><td class="paramname">num_attrib</td><td>The number of attributes that the keys will contain </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ace906c385ef5ce6bc7be9206cc5b3c06"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_fame_attrib_keys_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__fame__attrib__keys.html">cfe_fame_attrib_keys</a> *&#160;</td>
          <td class="paramname"><em>keys</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Frees the memory occupied by the struct members. It does not free the memory occupied by the struct itself.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">keys</td><td>A pointer to an instance of attribute keys (<em>initialized</em> <a class="el" href="structcfe__fame__attrib__keys.html">cfe_fame_attrib_keys</a> struct) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a8ceb339a1ed6336ee1a6cfd914207294"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_fame_generate_attrib_keys </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__fame__attrib__keys.html">cfe_fame_attrib_keys</a> *&#160;</td>
          <td class="paramname"><em>keys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>gamma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num_attrib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__fame__sec__key.html">cfe_fame_sec_key</a> *&#160;</td>
          <td class="paramname"><em>sk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__fame.html">cfe_fame</a> *&#160;</td>
          <td class="paramname"><em>fame</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The function given an array of attributes and master secret keys creates keys corresponding to attributes that can be used for the decryption.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">keys</td><td>A pointer to an initialized <a class="el" href="structcfe__fame__attrib__keys.html">cfe_fame_attrib_keys</a> struct, the keys for the decryption will be saved here </td></tr>
    <tr><td class="paramname">gamma</td><td>An array of attributes for which keys will be generated </td></tr>
    <tr><td class="paramname">num_attrib</td><td>Length of the array gamma, i.e. the number of attributes </td></tr>
    <tr><td class="paramname">sk</td><td>A pointer to a struct representing the secret keys </td></tr>
    <tr><td class="paramname">fame</td><td>A pointer to an initialized struct representing the scheme </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a1a740d53955478a2863f1e981386b07b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cfe_error cfe_fame_decrypt </td>
          <td>(</td>
          <td class="paramtype">FP12_BN254 *&#160;</td>
          <td class="paramname"><em>res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__fame__cipher.html">cfe_fame_cipher</a> *&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__fame__attrib__keys.html">cfe_fame_attrib_keys</a> *&#160;</td>
          <td class="paramname"><em>keys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__fame.html">cfe_fame</a> *&#160;</td>
          <td class="paramname"><em>fame</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The function takes as an input a cipher and keys and tries to decrypt the cipher. If the keys were properly generated, this is possible if and only if the rows of the MSP matrix corresponding to owned attributes span the vector [1, 0,..., 0]. If this is not possible, i.e. keys are insufficient, the function returns the corresponding error.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">res</td><td>An element of FP12_BN254, the decryption will be saved here </td></tr>
    <tr><td class="paramname">cipher</td><td>A pointer to an initialized struct representing the ciphertext </td></tr>
    <tr><td class="paramname">keys</td><td>A pointer to an initialized struct representing the keys for the decryption </td></tr>
    <tr><td class="paramname">fame</td><td>A pointer to an initialized struct representing the scheme </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code </dd></dl>

</div>
</div>
<a class="anchor" id="a26545c9f4bd6e4fc26b2c5e51318c5af"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* cfe_strings_concat_for_hash </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A helping function used in cfe_fame_encrypt and cfe_fame_generate_attrib_keys. </p>

</div>
</div>
<a class="anchor" id="a907c65676e69f263d8ec5a8ddb817c37"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* cfe_int_to_str </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A helping function used in cfe_fame_encrypt and cfe_fame_generate_attrib_keys. </p>

</div>
</div>
<a class="anchor" id="a5c2251b9ade6143f49604fb432450cc4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_hash_G1 </td>
          <td>(</td>
          <td class="paramtype">ECP_BN254 *&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>str</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A helping function used in cfe_fame_encrypt and cfe_fame_generate_attrib_keys. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
