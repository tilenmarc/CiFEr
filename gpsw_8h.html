<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>CiFEr: include/cifer/abe/gpsw.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CiFEr
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_3186075824eb6c6fc16d275650bc36ef.html">cifer</a></li><li class="navelem"><a class="el" href="dir_0d628d3c9b21a09631269a5f84e03143.html">abe</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">gpsw.h File Reference<div class="ingroups"><a class="el" href="group__abe.html">ABE schemes</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Key policy attribute based scheme.  
<a href="#details">More...</a></p>

<p><a href="gpsw_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcfe__gpsw.html">cfe_gpsw</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcfe__gpsw__pub__key.html">cfe_gpsw_pub_key</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcfe__gpsw__cipher.html">cfe_gpsw_cipher</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcfe__gpsw__keys.html">cfe_gpsw_keys</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a7a3e0160b5d09e87996915fa64b6ff64"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structcfe__gpsw.html">cfe_gpsw</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpsw_8h.html#a7a3e0160b5d09e87996915fa64b6ff64">cfe_gpsw</a></td></tr>
<tr class="separator:a7a3e0160b5d09e87996915fa64b6ff64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a145a56bbb09f9d31902062b29e6d7aa5"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structcfe__gpsw__pub__key.html">cfe_gpsw_pub_key</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpsw_8h.html#a145a56bbb09f9d31902062b29e6d7aa5">cfe_gpsw_pub_key</a></td></tr>
<tr class="separator:a145a56bbb09f9d31902062b29e6d7aa5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c04fdc7c836929258fd9ec65b2f78ad"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structcfe__gpsw__cipher.html">cfe_gpsw_cipher</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpsw_8h.html#a3c04fdc7c836929258fd9ec65b2f78ad">cfe_gpsw_cipher</a></td></tr>
<tr class="separator:a3c04fdc7c836929258fd9ec65b2f78ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa36eee6e0fd0808e0e132458cb515c10"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structcfe__gpsw__keys.html">cfe_gpsw_keys</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpsw_8h.html#aa36eee6e0fd0808e0e132458cb515c10">cfe_gpsw_keys</a></td></tr>
<tr class="separator:aa36eee6e0fd0808e0e132458cb515c10"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6e7804ad7be4f0f426654882453acd35"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpsw_8h.html#a6e7804ad7be4f0f426654882453acd35">cfe_gpsw_init</a> (<a class="el" href="structcfe__gpsw.html">cfe_gpsw</a> *gpsw, size_t l)</td></tr>
<tr class="separator:a6e7804ad7be4f0f426654882453acd35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3b55cbe5442ff3a8f7dc89b879dfbc7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpsw_8h.html#af3b55cbe5442ff3a8f7dc89b879dfbc7">cfe_gpsw_master_keys_init</a> (<a class="el" href="structcfe__gpsw__pub__key.html">cfe_gpsw_pub_key</a> *pk, <a class="el" href="structcfe__vec.html">cfe_vec</a> *sk, <a class="el" href="structcfe__gpsw.html">cfe_gpsw</a> *gpsw)</td></tr>
<tr class="separator:af3b55cbe5442ff3a8f7dc89b879dfbc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95cb32b71804da1dfadc19d1acfd46e3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpsw_8h.html#a95cb32b71804da1dfadc19d1acfd46e3">cfe_gpsw_generate_master_keys</a> (<a class="el" href="structcfe__gpsw__pub__key.html">cfe_gpsw_pub_key</a> *pk, <a class="el" href="structcfe__vec.html">cfe_vec</a> *sk, <a class="el" href="structcfe__gpsw.html">cfe_gpsw</a> *gpsw)</td></tr>
<tr class="separator:a95cb32b71804da1dfadc19d1acfd46e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f9f8bc1f5dbf5810bbca70a7f2c8faa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpsw_8h.html#a1f9f8bc1f5dbf5810bbca70a7f2c8faa">cfe_gpsw_cipher_init</a> (<a class="el" href="structcfe__gpsw__cipher.html">cfe_gpsw_cipher</a> *cipher, size_t num_attrib)</td></tr>
<tr class="separator:a1f9f8bc1f5dbf5810bbca70a7f2c8faa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5d002466f4be5189838669cd047c158"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpsw_8h.html#ab5d002466f4be5189838669cd047c158">cfe_gpsw_encrypt</a> (<a class="el" href="structcfe__gpsw__cipher.html">cfe_gpsw_cipher</a> *cipher, <a class="el" href="structcfe__gpsw.html">cfe_gpsw</a> *gpsw, FP12_BN254 *msg, int *gamma, size_t num_attrib, <a class="el" href="structcfe__gpsw__pub__key.html">cfe_gpsw_pub_key</a> *pk)</td></tr>
<tr class="separator:ab5d002466f4be5189838669cd047c158"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8e8b29b3bb219912604ad7eb902d2f5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpsw_8h.html#ad8e8b29b3bb219912604ad7eb902d2f5">cfe_gpsw_policy_keys_init</a> (<a class="el" href="structcfe__vec__G1.html">cfe_vec_G1</a> *policy_keys, <a class="el" href="structcfe__msp.html">cfe_msp</a> *msp)</td></tr>
<tr class="separator:ad8e8b29b3bb219912604ad7eb902d2f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a032a256a4a2813e4e759ad7663a6670e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpsw_8h.html#a032a256a4a2813e4e759ad7663a6670e">cfe_gpsw_generate_policy_keys</a> (<a class="el" href="structcfe__vec__G1.html">cfe_vec_G1</a> *key, <a class="el" href="structcfe__gpsw.html">cfe_gpsw</a> *gpsw, <a class="el" href="structcfe__msp.html">cfe_msp</a> *msp, <a class="el" href="structcfe__vec.html">cfe_vec</a> *sk)</td></tr>
<tr class="separator:a032a256a4a2813e4e759ad7663a6670e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cc884c6053ce0253e0e090b1b277dba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpsw_8h.html#a4cc884c6053ce0253e0e090b1b277dba">cfe_gpsw_rand_vec_const_sum</a> (<a class="el" href="structcfe__vec.html">cfe_vec</a> *v, mpz_t y, mpz_t p)</td></tr>
<tr class="separator:a4cc884c6053ce0253e0e090b1b277dba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a44ee3a24f8e1324a33a968d81b9727"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpsw_8h.html#a2a44ee3a24f8e1324a33a968d81b9727">cfe_gpsw_keys_init</a> (<a class="el" href="structcfe__gpsw__keys.html">cfe_gpsw_keys</a> *keys, <a class="el" href="structcfe__msp.html">cfe_msp</a> *msp, int *attrib, size_t num_attrib)</td></tr>
<tr class="separator:a2a44ee3a24f8e1324a33a968d81b9727"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17ef7a9f22ef9e9af773e4a68c861510"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpsw_8h.html#a17ef7a9f22ef9e9af773e4a68c861510">cfe_gpsw_delegate_keys</a> (<a class="el" href="structcfe__gpsw__keys.html">cfe_gpsw_keys</a> *keys, <a class="el" href="structcfe__vec__G1.html">cfe_vec_G1</a> *policy_keys, <a class="el" href="structcfe__msp.html">cfe_msp</a> *msp, int *attrib, size_t num_attrib)</td></tr>
<tr class="separator:a17ef7a9f22ef9e9af773e4a68c861510"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f0f94900203586a279aa327adc304aa"><td class="memItemLeft" align="right" valign="top">cfe_error&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpsw_8h.html#a4f0f94900203586a279aa327adc304aa">cfe_gpsw_decrypt</a> (FP12_BN254 *res, <a class="el" href="structcfe__gpsw__cipher.html">cfe_gpsw_cipher</a> *cipher, <a class="el" href="structcfe__gpsw__keys.html">cfe_gpsw_keys</a> *keys, <a class="el" href="structcfe__gpsw.html">cfe_gpsw</a> *gpsw)</td></tr>
<tr class="separator:a4f0f94900203586a279aa327adc304aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e29f5760cc15eb2c7fc8df0da02c507"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpsw_8h.html#a5e29f5760cc15eb2c7fc8df0da02c507">cfe_gpsw_free</a> (<a class="el" href="structcfe__gpsw.html">cfe_gpsw</a> *gpsw)</td></tr>
<tr class="separator:a5e29f5760cc15eb2c7fc8df0da02c507"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae01cd257c0e73b1c9a17c7af6bf226f5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpsw_8h.html#ae01cd257c0e73b1c9a17c7af6bf226f5">cfe_gpsw_pub_key_free</a> (<a class="el" href="structcfe__gpsw__pub__key.html">cfe_gpsw_pub_key</a> *pk)</td></tr>
<tr class="separator:ae01cd257c0e73b1c9a17c7af6bf226f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3d0903dc70f026b50110c7c3e21c1da"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpsw_8h.html#ae3d0903dc70f026b50110c7c3e21c1da">cfe_gpsw_cipher_free</a> (<a class="el" href="structcfe__gpsw__cipher.html">cfe_gpsw_cipher</a> *cipher)</td></tr>
<tr class="separator:ae3d0903dc70f026b50110c7c3e21c1da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af64938992f22f3bffc15791e5cd0ab8d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpsw_8h.html#af64938992f22f3bffc15791e5cd0ab8d">cfe_gpsw_keys_free</a> (<a class="el" href="structcfe__gpsw__keys.html">cfe_gpsw_keys</a> *keys)</td></tr>
<tr class="separator:af64938992f22f3bffc15791e5cd0ab8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Key policy attribute based scheme. </p>
<p>This is a key policy (KP) attribute based (ABE) scheme based on Goyal, Pandey, Sahai, Waters: "Attribute-Based Encryption for
Fine-Grained Access Control of Encrypted Data" We abbreviated it GPSW scheme to honor the authors. This scheme enables distribution of keys based on a boolean expression determining which attributes are needed for an entity to be able to decrypt. Each key is connected to some attribute, such that only a set of keys whose attributes are sufficient can decrypt the massage. This scheme is a PUBLIC-KEY scheme - no master secret key is needed to encrypt the messages. </p>
</div><h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="a7a3e0160b5d09e87996915fa64b6ff64"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structcfe__gpsw.html">cfe_gpsw</a>  <a class="el" href="structcfe__gpsw.html">cfe_gpsw</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="structcfe__gpsw.html">cfe_gpsw</a> represents the GPSW scheme. </p>

</div>
</div>
<a class="anchor" id="a145a56bbb09f9d31902062b29e6d7aa5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structcfe__gpsw__pub__key.html">cfe_gpsw_pub_key</a>  <a class="el" href="structcfe__gpsw__pub__key.html">cfe_gpsw_pub_key</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="structcfe__gpsw__pub__key.html">cfe_gpsw_pub_key</a> represents the public key for the GPSW scheme. </p>

</div>
</div>
<a class="anchor" id="a3c04fdc7c836929258fd9ec65b2f78ad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structcfe__gpsw__cipher.html">cfe_gpsw_cipher</a>  <a class="el" href="structcfe__gpsw__cipher.html">cfe_gpsw_cipher</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="structcfe__gpsw__cipher.html">cfe_gpsw_cipher</a> represents the ciphertext structure for the GPSW scheme. </p>

</div>
</div>
<a class="anchor" id="aa36eee6e0fd0808e0e132458cb515c10"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structcfe__gpsw__keys.html">cfe_gpsw_keys</a>  <a class="el" href="structcfe__gpsw__keys.html">cfe_gpsw_keys</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="structcfe__gpsw__cipher.html">cfe_gpsw_cipher</a> represents the key structure with all the keys corresponding owned attributes and is needed for the decryption in the GPSW scheme. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a6e7804ad7be4f0f426654882453acd35"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_gpsw_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw.html">cfe_gpsw</a> *&#160;</td>
          <td class="paramname"><em>gpsw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>l</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Configures a new instance of the scheme.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gpsw</td><td>A pointer to an uninitialized struct representing the scheme </td></tr>
    <tr><td class="paramname">l</td><td>The number of attributes that can be used in the scheme. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="af3b55cbe5442ff3a8f7dc89b879dfbc7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_gpsw_master_keys_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw__pub__key.html">cfe_gpsw_pub_key</a> *&#160;</td>
          <td class="paramname"><em>pk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__vec.html">cfe_vec</a> *&#160;</td>
          <td class="paramname"><em>sk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw.html">cfe_gpsw</a> *&#160;</td>
          <td class="paramname"><em>gpsw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initializes the structs which represent the master public and master secret key.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pk</td><td>A pointer to an uninitialized <a class="el" href="structcfe__gpsw__pub__key.html">cfe_gpsw_pub_key</a> struct </td></tr>
    <tr><td class="paramname">sk</td><td>A pointer to an uninitialized vector </td></tr>
    <tr><td class="paramname">gpsw</td><td>A pointer to an initialized struct representing the scheme </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a95cb32b71804da1dfadc19d1acfd46e3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_gpsw_generate_master_keys </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw__pub__key.html">cfe_gpsw_pub_key</a> *&#160;</td>
          <td class="paramname"><em>pk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__vec.html">cfe_vec</a> *&#160;</td>
          <td class="paramname"><em>sk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw.html">cfe_gpsw</a> *&#160;</td>
          <td class="paramname"><em>gpsw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generates master secret and public key.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pk</td><td>A pointer to a <a class="el" href="structcfe__gpsw__pub__key.html">cfe_gpsw_pub_key</a> struct which represents the master public key </td></tr>
    <tr><td class="paramname">sk</td><td>A pointer to a vector which represents the master public key </td></tr>
    <tr><td class="paramname">gpsw</td><td>A pointer to an initialized struct representing the scheme </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a1f9f8bc1f5dbf5810bbca70a7f2c8faa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_gpsw_cipher_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw__cipher.html">cfe_gpsw_cipher</a> *&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num_attrib</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initializes the struct which represents the ciphertext.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cipher</td><td>A pointer to an uninitialized <a class="el" href="structcfe__gpsw__cipher.html">cfe_gpsw_cipher</a> struct </td></tr>
    <tr><td class="paramname">num_attrib</td><td>The number of attributes </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ab5d002466f4be5189838669cd047c158"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_gpsw_encrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw__cipher.html">cfe_gpsw_cipher</a> *&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw.html">cfe_gpsw</a> *&#160;</td>
          <td class="paramname"><em>gpsw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FP12_BN254 *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>gamma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num_attrib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw__pub__key.html">cfe_gpsw_pub_key</a> *&#160;</td>
          <td class="paramname"><em>pk</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The function takes as an input a message given as a string, gamma a set of attributes that can be latter used in a decryption policy, and a public key. It creates an encryption of the message.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cipher</td><td>A pointer to a <a class="el" href="structcfe__gpsw__cipher.html">cfe_gpsw_cipher</a> struct, the ciphertext will be saved here </td></tr>
    <tr><td class="paramname">gpsw</td><td>A pointer to an initialized struct representing the scheme </td></tr>
    <tr><td class="paramname">msg</td><td>An element of FP12_BN254 representing the message </td></tr>
    <tr><td class="paramname">gamma</td><td>A pointer to an array of integers defining which attributes can be used for the decryption policy </td></tr>
    <tr><td class="paramname">num_attrib</td><td>Length of gamma </td></tr>
    <tr><td class="paramname">pk</td><td>A pointer to an initialized struct representing the public key </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ad8e8b29b3bb219912604ad7eb902d2f5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_gpsw_policy_keys_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__vec__G1.html">cfe_vec_G1</a> *&#160;</td>
          <td class="paramname"><em>policy_keys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__msp.html">cfe_msp</a> *&#160;</td>
          <td class="paramname"><em>msp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initializes the vector of elements on the elliptic curve which represents the policy keys.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">policy_keys</td><td>A pointer to an uninitialized <a class="el" href="structcfe__vec__G1.html">cfe_vec_G1</a> struct </td></tr>
    <tr><td class="paramname">msp</td><td>A pointer to an initialized struct representing the MSP policy </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a032a256a4a2813e4e759ad7663a6670e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_gpsw_generate_policy_keys </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__vec__G1.html">cfe_vec_G1</a> *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw.html">cfe_gpsw</a> *&#160;</td>
          <td class="paramname"><em>gpsw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__msp.html">cfe_msp</a> *&#160;</td>
          <td class="paramname"><em>msp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__vec.html">cfe_vec</a> *&#160;</td>
          <td class="paramname"><em>sk</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The function given a monotone span program (MSP) and the vector of secret keys produces a vector of keys needed for the decryption. In particular, for each row of the MSP matrix it creates a corresponding key. Since each row of the matrix has a corresponding key, this keys can be latter delegated to entities with corresponding attributes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>A pointer to a vector of elements of the elliptic curve, the keys will be saved here </td></tr>
    <tr><td class="paramname">gpsw</td><td>A pointer to an initialized struct representing the scheme </td></tr>
    <tr><td class="paramname">msp</td><td>A pointer to an initialized struct representing the MSP policy </td></tr>
    <tr><td class="paramname">sk</td><td>A pointer to an initialized struct representing the secret key </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a4cc884c6053ce0253e0e090b1b277dba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_gpsw_rand_vec_const_sum </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__vec.html">cfe_vec</a> *&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">mpz_t&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">mpz_t&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A helping function used in generate_policy_keys. </p>

</div>
</div>
<a class="anchor" id="a2a44ee3a24f8e1324a33a968d81b9727"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_gpsw_keys_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw__keys.html">cfe_gpsw_keys</a> *&#160;</td>
          <td class="paramname"><em>keys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__msp.html">cfe_msp</a> *&#160;</td>
          <td class="paramname"><em>msp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>attrib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num_attrib</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initializes the <a class="el" href="structcfe__gpsw__keys.html">cfe_gpsw_keys</a> struct which represents the keys for the decryption.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">keys</td><td>A pointer to an uninitialized <a class="el" href="structcfe__gpsw__keys.html">cfe_gpsw_keys</a> struct </td></tr>
    <tr><td class="paramname">msp</td><td>A pointer to an initialized struct representing the MSP policy </td></tr>
    <tr><td class="paramname">attrib</td><td>A pointer to an array of integers defining which attributes are owned to join corresponding keys to the final key for the decryption </td></tr>
    <tr><td class="paramname">num_attrib</td><td>The length of attrib </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a17ef7a9f22ef9e9af773e4a68c861510"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_gpsw_delegate_keys </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw__keys.html">cfe_gpsw_keys</a> *&#160;</td>
          <td class="paramname"><em>keys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__vec__G1.html">cfe_vec_G1</a> *&#160;</td>
          <td class="paramname"><em>policy_keys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__msp.html">cfe_msp</a> *&#160;</td>
          <td class="paramname"><em>msp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>attrib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num_attrib</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The function given the set of all keys produced from the MSP struct takes those that are specified and creates keys for the decryption.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">keys</td><td>A pointer to a <a class="el" href="structcfe__gpsw__keys.html">cfe_gpsw_keys</a> struct, the keys for the decryption will be saved here </td></tr>
    <tr><td class="paramname">policy_keys</td><td>A pointer to an initialized struct representing the keys of all the attributes </td></tr>
    <tr><td class="paramname">msp</td><td>A pointer to an initialized struct representing the MSP policy </td></tr>
    <tr><td class="paramname">attrib</td><td>A pointer to an array of integers defining which attributes are owned to join corresponding keys to the final key for the decryption </td></tr>
    <tr><td class="paramname">num_attrib</td><td>The length of attrib </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a4f0f94900203586a279aa327adc304aa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cfe_error cfe_gpsw_decrypt </td>
          <td>(</td>
          <td class="paramtype">FP12_BN254 *&#160;</td>
          <td class="paramname"><em>res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw__cipher.html">cfe_gpsw_cipher</a> *&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw__keys.html">cfe_gpsw_keys</a> *&#160;</td>
          <td class="paramname"><em>keys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw.html">cfe_gpsw</a> *&#160;</td>
          <td class="paramname"><em>gpsw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The function takes as an input a cipher and keys and tries to decrypt the cipher. If the keys were properly generated, this is possible if and only if the rows of the matrix in the key span the vector [1, 1,..., 1]. If this is not possible, i.e. keys are insufficient, the function returns the corresponding error.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">res</td><td>An element of FP12_BN254, the decryption will be saved here </td></tr>
    <tr><td class="paramname">cipher</td><td>A pointer to an initialized struct representing the ciphertext </td></tr>
    <tr><td class="paramname">keys</td><td>A pointer to an initialized struct representing the keys for the decryption </td></tr>
    <tr><td class="paramname">gpsw</td><td>A pointer to an initialized struct representing the scheme </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code </dd></dl>

</div>
</div>
<a class="anchor" id="a5e29f5760cc15eb2c7fc8df0da02c507"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_gpsw_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw.html">cfe_gpsw</a> *&#160;</td>
          <td class="paramname"><em>gpsw</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Frees the memory occupied by the struct members. It does not free memory occupied by the struct itself.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gpsw</td><td>A pointer to an instance of the scheme (<em>initialized</em> <a class="el" href="structcfe__gpsw.html">cfe_gpsw</a> struct) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ae01cd257c0e73b1c9a17c7af6bf226f5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_gpsw_pub_key_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw__pub__key.html">cfe_gpsw_pub_key</a> *&#160;</td>
          <td class="paramname"><em>pk</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Frees the memory occupied by the struct members. It does not free memory occupied by the struct itself.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pk</td><td>A pointer to an instance of the public key (<em>initialized</em> <a class="el" href="structcfe__gpsw__pub__key.html">cfe_gpsw_pub_key</a> struct) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ae3d0903dc70f026b50110c7c3e21c1da"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_gpsw_cipher_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw__cipher.html">cfe_gpsw_cipher</a> *&#160;</td>
          <td class="paramname"><em>cipher</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Frees the memory occupied by the struct members. It does not free memory occupied by the struct itself.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cipher</td><td>A pointer to an instance of the ciphertext (<em>initialized</em> <a class="el" href="structcfe__gpsw__cipher.html">cfe_gpsw_cipher</a> struct) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="af64938992f22f3bffc15791e5cd0ab8d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_gpsw_keys_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw__keys.html">cfe_gpsw_keys</a> *&#160;</td>
          <td class="paramname"><em>keys</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Frees the memory occupied by the struct members. It does not free memory occupied by the struct itself.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">keys</td><td>A pointer to an instance of the decryption keys (<em>initialized</em> <a class="el" href="structcfe__gpsw__keys.html">cfe_gpsw_keys</a> struct) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
